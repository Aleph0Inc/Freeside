<head>
  <title>Upgrading to 1.3.0</title>
</head>
<body>
<h1>Upgrading to 1.3.0 from 1.2.3</h1>
<ul>
  <li>If migrating from 1.0.0, see these <a href="upgrade.html">instructions</a> first.
  <li>If migrating from less than 1.1.4, see these <a href="upgrade2.html">instructions</a> first.
  <li>If migrating from less than 1.2.0, see these <a href="upgrade3.html">instructions</a> first.
  <li>If migrating from less than 1.2.2, see these <a href="upgrade4.html">instructions</a> first.
  <li>If migrating from less than 1.2.3, see these <a href="upgrade5.html">instructions</a> first.
  <li>Back up your data and current Freeside installation.
  <li>As 1.3.0 requires transactions, <b>MySQL's default <a href="http://www.mysql.com/doc/M/y/MyISAM.html">MyISAM</a> and <a href="http://www.mysql.com/doc/I/S/ISAM.html">ISAM</a> table types are no longer supported</b>.  Converting to <a href="http://www.postgresql.org/">PostgreSQL</a> is recommended.  If you really want to use MySQL, convert your tables to one of the <a href="http://www.mysql.com/doc/T/a/Table_types.html">transaction-safe table types</a> such as <a href="http://www.mysql.com/doc/B/D/BDB.html">BDB</a>.
  <li>Copy the <i>invoice_template</i> file from the <i>conf/</i> directory in the distribution to your <a href="config.html">configuration directory</a>.
  <li>Install the <a href="http://www.perl.com/CPAN/modules/by-module/Text/">Text-Template</a> Perl module.
  <li>Apply the following changes to your database:
<pre>
CREATE TABLE domain_record (
  recnum int NOT NULL,
  svcnum int NOT NULL,
  reczone varchar(80) NOT NULL,
  recaf char(2) NOT NULL,
  rectype char(5) NOT NULL,
  recdata varchar(80) NOT NULL,
  PRIMARY KEY (recnum)
);
CREATE TABLE svc_www (
  svcnum int NOT NULL,
  recnum int NOT NULL,
  usersvc int NOT NULL,
  PRIMARY KEY (svcnum)
);
ALTER TABLE part_svc ADD svc_www__recnum varchar(80) NULL;
ALTER TABLE part_svc ADD svc_www__recnum_flag char(1) NULL;
ALTER TABLE part_svc ADD svc_www__usersvc varchar(80) NULL;
ALTER TABLE part_svc ADD svc_www__uesrsvc_flag char(1) NULL;
ALTER TABLE svc_acct CHANGE _password _password varchar(50) NULL;
ALTER TABLE svc_acct ADD seconds integer NULL;
ALTER TABLE part_svc ADD svc_acct__seconds integer NULL;
ALTER TABLE part_svc ADD svc_acct__seconds_flag char(1) NULL;
ALTER TABLE prepay_credit ADD seconds integer NULL;

</pre>
  <li>If your database supports dropping columns:
<pre>
ALTER TABLE cust_bill DROP owed;
ALTER TABLE cust_credit DROP credited;
</pre>
     Or, if your database does not support dropping columns, you can do this:
<pre>
ALTER TABLE cust_bill CHANGE owed depriciated decimal(10,2);
ALTER TABLE cust_credit CHANGE credited depriciated2 decimal(10,2);
</pre>

  <li>Copy or symlink htdocs to the new copy.
  <li>Remove the symlink or directory <i>(your_site_perl_directory)</i>/FS.
  <li>Change to the FS directory in the new tarball, and build and install the
      Perl modules:
    <pre>
$ cd FS/
$ perl Makefile.PL
$ make
$ su
# make install</pre>
  <li>Run bin/dbdef-create.  This file uses MySQL-specific syntax.  If you are running a different database engine you will need to modify it slightly.
</body>
