#!/usr/bin/perl -Tw

use strict;
use FS::UID qw(adminsuidsetup);
use FS::Record qw(qsearch);
use FS::msgcat;

my $user = shift or die &usage;
adminsuidsetup $user;

foreach my $del_msgcat ( qsearch('msgcat', {}) ) {
  my $error = $del_msgcat->delete;
  die $error if $error;
}

my %messages = messages();

foreach my $msgcode ( keys %messages ) {
  foreach my $locale ( keys %{$messages{$msgcode}} ) {
    my $msgcat = new FS::msgcat( {
      'msgcode' => $msgcode,
      'locale'  => $locale,
      'msg'     => $messages{$msgcode}{$locale},
    });
    my $error = $msgcat->insert;
    die $error if $error;
  }
}

sub messages {

  #  'msgcode' => {
  #    'en_US' => 'Message',
  #  },

  (

    'passwords_dont_match' => {
      'en_US' => "Passwords don't match",
    },

    'invalid_card' => {
      'en_US' => 'Invalid credit card number',
    },

    'unknown_card_type' => {
      'en_US' => 'Unknown card type',
    },

    'not_a' => {
      'en_US' => 'Not a ',
    },

  );
}

sub usage {
  die "Usage:\n\n  populate-msgcat user\n";
}

