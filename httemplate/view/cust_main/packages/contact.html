% if ( $contact ) {
    <% $contact->line |h %>
% if ( $show_link ) {
        <FONT SIZE=-1>
          (&nbsp;<%pkg_change_contact_link($cust_pkg)%>&nbsp;)
        </FONT>
%    }
% } elsif ( $show_link ) {
        <FONT SIZE=-1>
          (&nbsp;<%pkg_add_contact_link($cust_pkg)%>&nbsp;)
        </FONT>
% }
<%init>

my $conf = new FS::Conf;
my %opt = @_;

my $cust_pkg       = $opt{'cust_pkg'};

my $show_link = 
  ! $cust_pkg->get('cancel')
  && $FS::CurrentUser::CurrentUser->access_right('Change customer package');

my $contact = $cust_pkg->contact_obj;

sub pkg_change_contact_link {
  my $cust_pkg = shift;
  #my $pkgpart = $cust_pkg->pkgpart;
  include( '/elements/popup_link-cust_pkg.html',
    'action'      => $p. "misc/change_pkg_contact.html",
    'label'       => emt('Change'), # contact'),
    'actionlabel' => emt('Change'),
    'cust_pkg'    => $cust_pkg,
  );
}

sub pkg_add_contact_link {
  my $cust_pkg = shift;
  #my $pkgpart = $cust_pkg->pkgpart;
  include( '/elements/popup_link-cust_pkg.html',
    'action'      => $p. "misc/change_pkg_contact.html",
    'label'       => emt('Add contact'),
    'actionlabel' => emt('Change'),
    'cust_pkg'    => $cust_pkg,
  );
}

#sub edit_contact_link {
#  my $contactnum = shift;
#  include( '/elements/popup_link.html',
#    'action'      => $p. "edit/cust_contact.cgi?contactnum=$contactnum",
#    'label'       => emt('Edit contact'),
#    'actionlabel' => emt('Edit'),
#  );
#}

</%init>
